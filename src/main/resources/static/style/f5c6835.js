(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{457:function(e,t,o){"use strict";o.r(t);var r={layout:"layout",head:function(){return{title:"Redis设置"}},data:function(){return{key:"",form:{redisHost:"",redisPassword:"",redisPort:"",redisPrefix:""}}},beforeDestroy:function(){},created:function(){},mounted:function(){var e=this;localStorage.getItem("webkey")?e.key=localStorage.getItem("webkey"):(e.$message({message:"认证失效！",type:"error"}),e.$router.push({path:"/"})),e.getConfig()},methods:{save:function(){var e=this,t="";localStorage.getItem("api_token")&&(t=localStorage.getItem("api_token"));var o=e.form,data={webkey:e.key,token:t,params:JSON.stringify(o)},r=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});e.$axios.$post(e.$api.setupRedis(),this.qs.stringify(data)).then((function(t){r.close(),1==t.code?(e.$alert("你已经完成配置修改，请立即重启RuleApi使配置生效！","安全提示",{confirmButtonText:"确定"}),e.getConfig()):(e.$message({message:t.msg,type:"error"}),"用户未登录或Token验证失败"==t.msg&&localStorage.removeItem("api_token"))})).catch((function(t){r.close(),console.log(t),e.$message({message:"接口请求异常，请检查网络！",type:"error"})}))},getConfig:function(){var e=this,t="";localStorage.getItem("api_token")&&(t=localStorage.getItem("api_token"));var data={webkey:e.key,token:t};e.$axios.$post(e.$api.allConfig(),this.qs.stringify(data)).then((function(t){1==t.code?(e.form.redisHost=t.data.redisHost,e.form.redisPassword=t.data.redisPassword,e.form.redisPort=t.data.redisPort,e.form.redisPrefix=t.data.redisPrefix):(e.$message({message:t.msg,type:"error"}),"用户未登录或Token验证失败"==t.msg&&localStorage.removeItem("api_token"))})).catch((function(t){console.log(t),e.$message({message:"接口请求异常，请检查网络！",type:"error"})}))}}},l=o(26),component=Object(l.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-container"},[t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"data-box"},[t("div",{staticClass:"page-title"},[t("h4",[e._v("Redis设置")]),e._v(" "),t("p",[e._v("Redis用于验证用户登录状态，缓存低更新率数据，"),t("span",{staticClass:"title-important"},[e._v("修改后需重启接口生效")]),e._v("。")])]),e._v(" "),t("div",{staticClass:"page-form"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-position":"top","label-width":"80px"}},[t("el-form-item",[t("p",{staticClass:"form-label",attrs:{slot:"label"},slot:"label"},[e._v("Redis地址")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入Redis地址"},model:{value:e.form.redisHost,callback:function(t){e.$set(e.form,"redisHost",t)},expression:"form.redisHost"}})],1),e._v(" "),t("el-form-item",[t("p",{staticClass:"form-label",attrs:{slot:"label"},slot:"label"},[e._v("Redis密码")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入Redis密码"},model:{value:e.form.redisPassword,callback:function(t){e.$set(e.form,"redisPassword",t)},expression:"form.redisPassword"}})],1),e._v(" "),t("el-form-item",[t("p",{staticClass:"form-label",attrs:{slot:"label"},slot:"label"},[e._v("Redis端口")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入Redis端口"},model:{value:e.form.redisPort,callback:function(t){e.$set(e.form,"redisPort",t)},expression:"form.redisPort"}})],1),e._v(" "),t("el-form-item",[t("p",{staticClass:"form-label",attrs:{slot:"label"},slot:"label"},[e._v("Redis数据前缀"),t("span",[e._v("在同时存在多个RuleApi服务时，防止数据紊乱")])]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入Redis数据前缀"},model:{value:e.form.redisPrefix,callback:function(t){e.$set(e.form,"redisPrefix",t)},expression:"form.redisPrefix"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("保存设置")])],1)],1)],1)])])],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);